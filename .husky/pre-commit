#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "Auto-formatting changed files..."

# Check if there are backend changes
if git diff --cached --name-only | grep -q "^backend/"; then
  echo "Formatting backend..."
  cd backend && ./mvnw spotless:apply
  cd ..
  git add backend/
else
  echo "Skipping backend (no changes)"
fi

# Check if there are frontend changes
if git diff --cached --name-only | grep -q "^frontend/"; then
  echo "Formatting frontend..."
  cd frontend && pnpm prettier:write
  cd ..
  git add frontend/
else
  echo "Skipping frontend (no changes)"
fi

echo "Done!"
